# 中国期货市场监控中心期货结算单下载器

## 项目简介
期货结算单下载器是一个基于Python和PyQt5的桌面应用程序，用于自动下载中国期货市场监控中心（CFMMC）的期货结算单。该工具支持多账户管理、批量下载日报和月报数据，并提供直观的用户界面。

## 主要功能
- **账户管理**：添加、编辑、删除期货账户信息
- **批量下载**：同时下载多个账户的结算单
- **报表类型**：支持日报（逐日/逐笔）和月报（逐日/逐笔）
- **日期范围**：自定义下载的起始和结束日期
- **验证码识别**：自动识别登录验证码（使用ddddocr）
- **下载进度**：实时显示下载进度和状态
- **撤销操作**：支持撤销误删的账户
- **搜索过滤**：快速查找特定账户

## 运行环境
- Python 3.7+
- 操作系统：Windows/Linux/macOS

## 依赖库
```text
PyQt5==5.15.11
requests==2.32.4
beautifulsoup4==4.13.4
ddddocr==1.5.6
pillow==11.3.0
```

## 项目结构
```text
futures-statement-downloader/
├── main.py               # 程序入口
├── config.json           # 配置文件（自动生成）
├── requirements.txt      # 依赖库列表
├── README.md             # 项目说明文档
└── downloads/            # 默认下载目录（自动创建）
    ├── 事业部名称/
    │   ├── 逐日/
    │   │   └── 事业部名称-公司简称_2023-01-01.xls
    │   └── 逐笔/
    │       └── 事业部名称-公司简称_2023-01-01.xls
    └── 月报/
        ├── 逐日/
        │   └── 事业部名称-公司简称_2023-01.xls
        └── 逐笔/
            └── 事业部名称-公司简称_2023-01.xls
```

## 错误处理
- **验证码错误**：如果自动识别验证码失败次数过多，会提示手动输入。
- **用户名密码错误**：登录凭据不正确时会给出提示。
- **下载失败**：在下载特定报表时遇到网络或其他问题，会显示具体的错误信息。

## 注意事项
- 本工具仅供个人学习和研究使用，请勿用于非法用途。
- 请确保您的网络连接稳定。
- 首次运行或配置文件不存在时，会自动创建 `config.json` 文件。
- 	密码以明文形式存储在 `config.json` 中，请注意保护您的文件安全。

## 内容改动
- 2025.7.10 将进度显示和错误提示中的 `account['division_name']` 改为 `account['company_short']` 及 `account['account_no']`
